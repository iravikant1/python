import yfinance as yf
import sqlite3

# Fetch stock data
ticker = "AAPL"
data = yf.download(ticker, period="5d")  # last 5 days

# Connect to SQLite
conn = sqlite3.connect("stocks.db")
cursor = conn.cursor()

# Create table if not exists
cursor.execute("""
CREATE TABLE IF NOT EXISTS stock_prices (
    date TEXT,
    open REAL,
    high REAL,
    low REAL,
    close REAL,
    volume INTEGER
)
""")

# Insert data
for index, row in data.iterrows():
    cursor.execute("""
        INSERT INTO stock_prices (date, open, high, low, close, volume)
        VALUES (?, ?, ?, ?, ?, ?)
    """, (str(index.date()), row['Open'], row['High'], row['Low'], row['Close'], row['Volume']))

conn.commit()
conn.close()

print("Stock data saved to SQL database!")
